<!doctype html>
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>大逃杀行动结算</title>
<style>
    input {
        font-size: 1rem;
    }
</style>
<!--{% if name %}
  <h1>Hello {{ name }}!</h1>
{% else %}
  <h1>Hello, World!</h1>
{% endif %}-->
<h3>反馈行动</h3>
<form action="{{ send_url }}" method="POST">
    <input type="text" name="to" id="to" placeholder="反馈对象" size=10 value="{{ to }}"/>
    <input type="text" name="content" id="content" placeholder="反馈内容" size=30 autofocus="autofocus" value="{{ content }}"/>
    <input type="submit" value="发送"/>
</form>

<h3>历史行动</h3>
{% for message in messages | reverse %}
    {% if message.read %}
    <p>
    {% else %}
    <p style="color:blue">
    {% endif %}
        {{ message.time }} 角色 <b>{{ message.from }}</b> 对 <b>{{ message.to }}</b> 说：<br/>
        {{ message.content }}
    </p>
{% endfor %}

<!--
<script>
    function setCaretPosition(input, pos){
        if (input.setSelectionRange){
            setTimeout(function() {
                input.setSelectionRange(pos, pos);
                input.focus();
            }, 5);
        }
    }

    function refresh() {
        const dst = document.getElementById("to").value;
        const text = document.getElementById("content").value;
        location.href = location.pathname + "?to=" + dst + "&content=" + text;
    }

    const input = document.getElementById("content");
    setCaretPosition(input, input.value.length);
    setTimeout("refresh();", 60000);
</script>
-->
